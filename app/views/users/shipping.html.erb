<%= render partial: 'partials/header' %>

<div class="container">
  
  <div class="row" id='step-top-row'>
    <div class="col s12 center">
      <p class='account-header'><strong>Checkout</strong></p>
    </div>
  </div>

  <div class="row">
    <div class="col s4 offset-s2" id='step-col'>
      <p class='account-steps' id='step-1'>1. Shipping</p>
    </div>
    <div class="col s4" id='step-col'>
      <p class='account-steps' id='inactive'>2. Payment</p>
    </div>
  </div>

  <div class="row">
    <div class="col s12 l6" id='step-top-row'>
      <p class="account-steps"><strong>Choose Shipping Address</strong></p>
      <% if current_user.addresses.length > 0 %>
          <% current_user.addresses.each do |address| %>
          <div class="row">
            <div class="col s9">
              <!-- <p class='account-address-name'><strong><#%= current_user.name %></strong></p> -->
              <p class='acount-address-info'><strong> <%= address.name %> </strong></p>
              <p class='acount-address-info'><%= address.address %></p>
              <p class='acount-address-info'><%= address.city %>, <%= address.state %> <%= address.zip %></p>
              <p class='acount-address-info'><%= address.country %></p>
            </div>
            <div class="col s3">
              <% if address.active === 'yes' %>
                <i class="small green-text material-icons">done</i>
              <% end %>
              <% if address.active === 'no' %>
                <%= form_for address do |f| %>
                  <%= f.hidden_field :active, :value => 'yes' %>
                  <%= f.submit "Select", :class => 'select-address'%>
                <% end %>
              <% end %>
            </div>
          </div>
         <% end %>
        <% end %>
      <p class='shipping-disclaimer-text'>
        DealBaked ships to all 50 U.S. states. We cannot ship to P.O. Boxes.<br>
        We're constantly working on expanding our shipping options and adding international shipping.
      </p>
    </div>
    <div class="col s12 l6 grey lighten-2" id='step-top-row'>
        <div class="total-container">
          <div class="center">
            <p class='account-header'>Order Summary</p>
          </div>
          <div class='grey-text darken-4 subtotals'>
            <p>Item Subtotal: <span class='right amount'>$<%= @amount %>.00</span></p>
            <p>Sales Tax:</p>
          </div>
          <div class='subtotals'>
            <p>Total:</p>
          </div>
        </div>
        <div class='right'>
        <% if @current_user_address.exists? %>
          <%= button_to "Next", new_charge_path, :class => "btn waves-effect grey darken-3", method: :get, :style => "margin-left: 45%; margin-top: 10px" %>
        <% end %>
        </div>
      </div>
      <div class="col s6 offset-s6 left-align">
        
      </div>
    </div>
  </div>



<!--<% if @current_user_address.exists? %>
  <div id = "address" style="border:1px solid black; padding:10px; width:49%; text-align:center; display: inline-block; float: left">
    <h3>Ship to: </h3>
      <h4> <%= @current_user_address[0].name %> </h4>
      <h4> <%= @current_user_address[0].address %> </h4>
      <h5> <%= @current_user_address[0].city %>, <%= @current_user_address[0].state%> <%= @current_user_address[0].zip %> </h5>
      <h5> <%= @current_user_address[0].country %> </h5>
  </div>
<% else %>
  <h3>Select Shipping Address: </h3>
  <% current_user.addresses.each do |address| %>
    <% if address.active === 'no' %>
    <div style="width:49%; border: 1px solid black; text-align:center; display: inline-block; float: right; height: 220px">
        <h5> <%= address.name %> </h5>
        <h5> <%= address.address %> </h5>
        <h6> <%= address.city %>, <%= address.state%> <%= address.zip %> </h6>
        <h6> <%= address.country %> </h6>
        <%= form_for address do |f| %>
          <%= f.hidden_field :active, :value => 'yes' %>
          <%= f.submit "Ship to this address" %>
        <% end %>
      </div>
    <% end %>
  <% end %>
<% end %> -->

</br>

<div id = "address" style="border:1px solid black; padding:10px; width:49%; text-align:center; display: inline-block; float: left; margin-top: 50px">
  <h3>New Shipping Address:</h3>
<%= form_for Address.new do |f| %>
  <%= f.hidden_field :user_id, :value => current_user.id %>
  <%= f.text_field :name, :placeholder => "Shipping Name", :required => true %>
  <%= f.text_field :country, :placeholder => "Country", :required => true %>
  <%= f.text_field :state, :placeholder => "State", :required => true %>
  <%= f.text_field :city, :placeholder => "City", :required => true %>
  <%= f.number_field :zip, :placeholder => "Zip Code", :required => true %>
  <%= f.text_field :address, :placeholder => "Address", :required => true %>
  <%= f.hidden_field :active, :value => 'no' %>
  <%= f.submit "Create Shipping Address" %>
<% end %>
</div>

<!-- <h3> Other Shipping Addresses: </h3>
<% current_user.addresses.each do |address| %>
  <% if address.active === 'no' %>
  <div style="width:49%; border: 1px solid black; text-align:center; display: inline-block; float: right; height: 220px">
      <h5> <%= address.name %> </h5>
      <h5> <%= address.address %> </h5>
      <h6> <%= address.city %>, <%= address.state%> <%= address.zip %> </h6>
      <h6> <%= address.country %> </h6>
      <%= form_for address do |f| %>
        <%= f.hidden_field :active, :value => 'yes' %>
        <%= f.submit "Ship to this address" %>
      <% end %>
      <%= button_to "Remove Address", address_path(address.id), method: :delete, data: { confirm: 'Are you sure you want to delete this address?' } %>
    </div>
  <% end %>
<% end %>
</br> </br> -->

<% if @current_user_address.exists? %>
  <%= button_to "Next", new_charge_path, :class => "btn green", method: :get, :style => "margin-left: 45%; margin-top: 10px" %>
<% end %>

</div>
<%= render partial: 'partials/footer' %>
